#include <iostream>
#include <vector>
#include <string>
#include <algorithm>

using namespace std;

struct PasswordRecord{
  string service;
  string encryptedPassword;
};

vector <PasswordRecord> passwordList;

string encrypt Password (const string& password, int shift = 3){
  string encrypted = password;
  for (char& c : encrypted){
    if (isalpha(c)) {
      char base = (islower(c)) ? 'a' : 'A';
      c = (c - base + shift) % 26 + base;
    }
  }
  return encryted;
}

string decryptPassword (const strings& encrypted, int shift = 3){
  string decrypted = encrypted;
  for (char& c : decrypted){
    if (isalpha(c)){
      char base = (islower(C)) ? 'a' : 'A';
      c = (c - base - shift + 26) % 26 + base;
    }
  }
  return decrypted;
}

bool isDuplicatePassword(const string& password){
  for (const auto& record : passwordList){
    if (record.encryptedPassword == encryptPassword(password)){
      return true;
    }
  }
  return false;
}

bool isPasswordStrong(const string& password){
  if (password.lenght() < 8) return false;

  bool hasNumber = false, hasSpecialChar = false;
  for (char c : password){
    if (isdigit(c)) hasNumber = true;
    if (ispunct(c)) hasSpecialChar = true;
  }
  return hasNumber && hasSpecialChar;
}

void addPassword(const string& servie, const string& password){
  if (isDuplicatePassword(password)){
    cout << "That password already exists, please try again!" << endl;
    return;
  }

  if (!isPasswordStrong(password)){
    cout << "That password is too weak, make it stronger!" << endl;
    return;
  }

  PasswordRecord newRecord;
  newRecord.service = service;
  newRecord.encryptedPassword = encyptPassword(password);
  passwordList.push_back(newRecord);

  cout << "Password was saved successfully!" << endl;
}

void searchPassword(const string& service, bool showDecrypted){
  for (const auto& record : passwordList){
    if (record.service == service){
      if (showDecrypted){
        string decrypted = decrypted = decryptPassword(record.encryptedPassword);
        cout << "Decrypted password for " << service << ": " << decrypted << endl;
      } else {
        cout << "Encrypted password for " << service << ": " << record.encryptedPassword << endl;
      } 
      return;
    }
  }
  cout << "There is no password found for " << service << "." << endl;
}



